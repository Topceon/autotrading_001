def foo(data_list):
    list_close_line = []
    for c in data_list:
        e = [i[4] for i in data_list[c]]
        list_close_line.append(sum(e) / len(e))
    return list_close_line


def ofsets(m):
    percent = m / 100
    e = [[m + percent * 1.5, 'SELL'], [m - percent * 1.5, 'BUY']]
    if _:
        e.append([m + percent * 0.5, 'SELL'])
    if _:
        e.append([m - percent * 0.5, 'BUY'])
    return e


def strategy(data_list):
    a = foo(data_list)
    coins_actions = []
    for i in a:
        coin_actions = ofsets(i)
        coins_actions.append(coin_actions)
    return list


if __name__ == '__main__':
    # входящие данные
    # {'ARBUSDT': [[время входа, цена открытия, максимум свечи, минимум свечи, цена закрытия, объем],
    #               [время входа, цена открытия, максимум свечи, минимум свечи, цена закрытия, объем],
    #               [время входа, цена открытия, максимум свечи, минимум свечи, цена закрытия, объем]]}
    # результат {'symbol': 'ARBUSDT', 'type': 'STOP_MARKET', 'side': 'SELL', 'stopprice': 1.7018, 'quantity': 8}
    strategy({'BTCUSDT': [
        [1712233740000, '66579.90', '66620.00', '66564.70', '66568.40', '254.748', 1712233799999, '16963452.77900',
         2667, '72.475', '4826446.96280', '0'],
        [1712233800000, '66568.40', '66615.30', '66543.70', '66543.70', '144.332', 1712233859999, '9611239.77320', 2741,
         '74.331', '4949933.39410', '0'],
        [1712233860000, '66543.80', '66561.90', '66492.00', '66522.30', '237.332', 1712233919999, '15786843.74110',
         3629, '87.229', '5802234.39360', '0'],
        [1712233920000, '66522.30', '66568.30', '66522.20', '66526.60', '72.659', 1712233979999, '4835099.26980', 1382,
         '35.757', '2379238.62620', '0']], 'ETHUSDT': [
        [1712233740000, '3350.22', '3351.59', '3349.03', '3349.03', '1065.810', 1712233799999, '3570926.49383', 1616,
         '350.675', '1174829.27900', '0'],
        [1712233800000, '3349.04', '3350.35', '3348.29', '3348.29', '1594.264', 1712233859999, '5340545.74296', 1976,
         '612.468', '2051718.08410', '0'],
        [1712233860000, '3348.30', '3348.52', '3345.60', '3346.45', '1223.616', 1712233919999, '4095140.54683', 2658,
         '383.666', '1283911.84109', '0'],
        [1712233920000, '3346.45', '3348.24', '3346.05', '3346.45', '286.454', 1712233979999, '958765.39167', 1217,
         '130.218', '435853.67150', '0']], 'LTCUSDT': [
        [1712233740000, '99.93', '99.96', '99.86', '99.87', '2021.613', 1712233799999, '201946.16639', 418, '711.818',
         '71102.78752', '0'],
        [1712233800000, '99.87', '100.07', '99.85', '99.85', '3065.087', 1712233859999, '306306.93323', 569, '1241.612',
         '124104.45104', '0'],
        [1712233860000, '99.85', '99.91', '99.74', '99.90', '2440.842', 1712233919999, '243643.41730', 575, '1285.763',
         '128340.36097', '0'],
        [1712233920000, '99.90', '100.16', '99.88', '100.02', '3697.456', 1712233979999, '369944.10364', 651,
         '2096.001', '209755.26856', '0']]}
             )
